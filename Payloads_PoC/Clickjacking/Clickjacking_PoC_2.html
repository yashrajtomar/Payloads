<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Framing PoC — Attack Page</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; padding:20px;}
    .ok{color:green}
    .fail{color:red}
    iframe{border:1px solid #ccc; width:100%; height:700px}
    .box{padding:12px;border-radius:6px;background:#f7f7f7;margin-top:12px;}
    pre{background:#111;color:#eee;padding:12px;border-radius:6px;overflow:auto;}
  </style>
</head>
<body>
  <h1>Framing Proof-of-Concept</h1>
  <p>This page attempts to embed the target page in an <code>&lt;iframe&gt;</code>. Use this to demonstrate whether the target allows framing.</p>

  <label for="target">Target URL:</label>
  <input id="target" style="width:80%" value="TARGET_URL_HERE" />
  <button id="load">Load in iframe</button>

  <div class="box" id="result">
    <strong>Status:</strong> <span id="status">idle</span>
    <div id="details"></div>
  </div>

  <h3>Embedded iframe</h3>
  <iframe id="victimFrame" src="about:blank" sandbox></iframe>

  <h3>Useful notes (paste in report)</h3>
  <pre id="pocNotes">Replace TARGET_URL_HERE with the real target URL before use.
Captured request/response can be pasted below for context.
</pre>

<script>
(function(){
  const btn = document.getElementById('load');
  const targetInput = document.getElementById('target');
  const statusEl = document.getElementById('status');
  const details = document.getElementById('details');
  const iframe = document.getElementById('victimFrame');

  function setStatus(text, cls){
    statusEl.textContent = text;
    statusEl.className = cls||'';
  }

  function appendDetail(txt){
    const d = document.createElement('div');
    d.textContent = txt;
    details.appendChild(d);
  }

  // helper to detect if iframe loaded content (best-effort; cross-origin limits reading)
  function testFrameLoad(url){
    setStatus('loading…', '');
    details.innerHTML = '';

    // remove sandbox to allow normal embedding behavior if needed
    iframe.removeAttribute('sandbox');

    // set a timer to treat load as blocked if onload doesn't fire
    let loaded = false;
    const timeout = setTimeout(()=> {
      if(!loaded){
        // if onload not fired, attempt to see if contentWindow exists
        try{
          // accessing location.href will throw for cross-origin, but will exist if content loaded and allowed
          const cw = iframe.contentWindow;
          const href = cw && cw.location && cw.location.href;
          appendDetail('Timeout waiting for iframe onload. contentWindow.location.href = ' + (href||'unavailable'));
        }catch(e){
          appendDetail('Timeout: attempted access to iframe contentWindow threw an exception (likely cross-origin or blocked). Exception: ' + e);
        }
        setStatus('likely blocked or refused', 'fail');
      }
    }, 4000);

    iframe.onload = function(){
      loaded = true;
      clearTimeout(timeout);
      // on some cases, onload fires even when browser displays blocked message — double check
      try{
        // try a same-origin read (will fail if cross-origin; that's expected)
        const doc = iframe.contentDocument || iframe.contentWindow.document;
        const title = doc && doc.title;
        appendDetail('iframe onload fired. Document title (if accessible): ' + (title||'not available (cross-origin)'));
      }catch(e){
        appendDetail('iframe onload fired but cannot read content due to cross-origin (expected).');
      }
      setStatus('iframe loaded (may be framed)', 'ok');
    };

    // Set src last to trigger load
    iframe.src = url;
  }

  btn.addEventListener('click', ()=>{
    const url = targetInput.value.trim();
    if(!url){
      alert('Please enter target URL.');
      return;
    }
    // update PoC notes block
    document.getElementById('pocNotes').textContent = 'Attack page embedding: ' + url + '\n\n(If the iframe shows the target site, framing is allowed.)\n\nCaptured request/response:\n\n[PASTE BURP REQUEST/RESPONSE HERE]';
    testFrameLoad(url);
  });

  // convenience: load automatically if template contains real URL
  if(targetInput.value && targetInput.value !== 'TARGET_URL_HERE'){
    // do nothing automatically; wait for user to click to avoid noise
  }
})();
</script>
</body>
</html>
